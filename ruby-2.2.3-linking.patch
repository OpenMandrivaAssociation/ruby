diff --git a/Makefile.in b/Makefile.in
index 0756d17..0bf305f 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -238,7 +238,7 @@ $(LIBRUBY_A):
 $(LIBRUBY_SO):
 		@-$(PRE_LIBRUBY_UPDATE)
 		$(ECHO) linking shared-library $@
-		$(Q) $(LDSHARED) $(DLDFLAGS) $(OBJS) $(DLDOBJS) $(SOLIBS) $(EXTSOLIBS) $(OUTFLAG)$@
+		$(Q) $(LDSHARED) $(DLDFLAGS) $(CFLAGS) $(OBJS) $(DLDOBJS) $(SOLIBS) $(EXTSOLIBS) $(OUTFLAG)$@
 		-$(Q) $(OBJCOPY) -w -L '$(SYMBOL_PREFIX)Init_*' -L '$(SYMBOL_PREFIX)*_threadptr_*' $@
 		$(Q) $(POSTLINK)
 		@-$(MINIRUBY) -e 'ARGV.each{|link| File.delete link rescue nil; \
diff --git a/ext/rbconfig/sizeof/depend b/ext/rbconfig/sizeof/depend
index 1bcaa9c..0f1a13b 100644
--- a/ext/rbconfig/sizeof/depend
+++ b/ext/rbconfig/sizeof/depend
@@ -1,6 +1,6 @@
-sizes.c: $(top_srcdir)/tool/generic_erb.rb $(top_srcdir)/template/sizes.c.tmpl $(top_srcdir)/configure.in
+sizes.c: $(top_srcdir)/tool/generic_erb.rb $(top_srcdir)/template/sizes.c.tmpl $(top_srcdir)/configure.ac
 	$(Q) $(RUBY) $(top_srcdir)/tool/generic_erb.rb --output=$@ \
-		$(top_srcdir)/template/sizes.c.tmpl $(top_srcdir)/configure.in
+		$(top_srcdir)/template/sizes.c.tmpl $(top_srcdir)/configure.ac
 
 # AUTOGENERATED DEPENDENCIES START
 sizes.o: $(RUBY_EXTCONF_H)
