--- ruby-1.9.3-p0/lib/mkmf.rb.stdout~	2011-08-11 08:07:37.000000000 +0200
+++ ruby-1.9.3-p0/lib/mkmf.rb	2012-01-18 19:14:28.027920880 +0100
@@ -237,8 +237,6 @@ end
 module Logging
   @log = nil
   @logfile = 'mkmf.log'
-  @orgerr = $stderr.dup
-  @orgout = $stdout.dup
   @postpone = 0
   @quiet = $extmk
 
@@ -249,12 +247,20 @@ module Logging
 
   def self::open
     log_open
+    orgerr = $stderr.dup
+    orgout = $stdout.dup
     $stderr.reopen(@log)
     $stdout.reopen(@log)
     yield
   ensure
-    $stderr.reopen(@orgerr)
-    $stdout.reopen(@orgout)
+    if orgerr
+      $stderr.reopen(orgerr)
+      orgerr.close
+    end
+    if orgout
+      $stdout.reopen(orgout)
+      orgout.close
+    end
   end
 
   def self::message(*s)
